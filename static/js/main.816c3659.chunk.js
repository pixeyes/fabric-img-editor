(this["webpackJsonp@vft-aurora/fabric-img-editor"]=this["webpackJsonp@vft-aurora/fabric-img-editor"]||[]).push([[0],{132:function(e,t,n){e.exports=n(258)},137:function(e,t,n){var a=n(32),r=n(52);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(52,(function(){"string"===typeof(r=(r=n(52)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},138:function(e,t,n){var a=n(32),r=n(53);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(53,(function(){"string"===typeof(r=(r=n(53)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},139:function(e,t,n){var a=n(32),r=n(54);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(54,(function(){"string"===typeof(r=(r=n(54)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},140:function(e,t,n){var a=n(32),r=n(55);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(55,(function(){"string"===typeof(r=(r=n(55)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},254:function(e,t){},255:function(e,t){},256:function(e,t){},258:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(12),i=n.n(o),l=(n(137),n(138),n(139),n(140),n(126)),c=n(27),s=n.n(c),d=n(51),u=n(106),f=n(107),h=n(45),v=n(130),m=n(127);function g(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u7f16\u7ec4"},r.a.createElement("path",{d:"M10.8,4.4 L2.5,4.4 C2.22386,4.4 2,4.17614 2,3.9 L2,2.5 C2,2.22386 2.22386,2 2.5,2 L21.5,2 C21.7761,2 22,2.22386 22,2.5 L22,3.9 C22,4.17614 21.7761,4.4 21.5,4.4 L13.2,4.4 L13.2,20.69995 C13.2,20.97615 12.9761,21.19995 12.7,21.19995 L11.3,21.19995 C11.0239,21.19995 10.8,20.97615 10.8,20.69995 L10.8,4.4 Z",id:"\u8def\u5f84",fill:"currentColor"}),r.a.createElement("rect",{id:"\u77e9\u5f62",x:"0",y:"0",width:"24",height:"24"}))))}g.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-type"};var p=g;function w(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u7f16\u7ec4"},r.a.createElement("path",{d:"M2.29909188,21.6008583 C1.90030271,21.2020995 1.90030271,20.5555078 2.29909188,20.156749 L16.5491086,5.90669248 L15.0049277,4.36251055 L22,2 L19.6374705,8.99505636 L18.0932896,7.45087442 L3.84327283,21.7009309 C3.44448366,22.0996897 2.7979332,22.0996897 2.39914402,21.7009309 L2.29909188,21.6008583 Z",id:"\u8def\u5f84",fill:"currentColor"}),r.a.createElement("rect",{id:"\u77e9\u5f62",x:"0",y:"0",width:"24",height:"24"}))))}w.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-arrow-left"};var C=w;var x=function(e){return r.a.createElement("svg",Object.assign({width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M20 4H4V20H20V4ZM2 2V22H22V2H2Z",fill:"currentColor"}))};function b(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u7f16\u7ec4",transform:"translate(-0.000000, 0.000000)"},r.a.createElement("path",{d:"M19.7173975,1.56321024 C18.9664975,0.812284252 17.7489975,0.812242252 16.9979975,1.56321024 L7.4347775,11.1264001 C7.0685375,11.4927001 6.7614275,11.9136001 6.5244275,12.3741001 L5.4406075,14.4803001 L3.4010675,17.8795001 L6.1204575,20.5989 L9.5196875,18.5594001 L11.6258975,17.4756001 C12.0863975,17.2386001 12.5072975,16.9315001 12.8735975,16.5652001 L22.4367975,7.00199019 C23.1877975,6.2510202 23.1876975,5.03353021 22.4367975,4.28260022 L19.7173975,1.56321024 Z M4.3585075,20.1974001 L5.4401875,21.2792 C3.4010675,23.3183 1.0211875,22.9788 1.0211875,22.9788 C1.0211875,22.9788 0.681675505,20.5989 2.7207975,18.5598001 C2.9322675,18.7708001 3.6683075,19.5070001 4.3585075,20.1974001 Z M16.0102975,5.35355021 C15.8149975,5.15829021 15.4983975,5.15829021 15.3031975,5.35355021 L10.3533975,10.3033002 C10.1581975,10.4986002 10.1581975,10.8151001 10.3533975,11.0104001 C10.5486975,11.2057001 10.8652975,11.2057001 11.0604975,11.0104001 L16.0102975,6.0606602 C16.2055975,5.8654002 16.2055975,5.5488202 16.0102975,5.35355021 Z",id:"\u5f62\u72b6",fill:"currentColor"}),r.a.createElement("rect",{id:"\u77e9\u5f62",x:"0",y:"0",width:"24",height:"24"}))))}b.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-edit-2"};var k=b;function E(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u7f16\u7ec4"},r.a.createElement("path",{d:"M10.7071,2.29289 C11.0976,2.68342 11.0976,3.31658 10.7071,3.70711 L7.41421,7 L12.75,7 C16.7541,7 20,10.2459 20,14.25 C20,18.2541 16.7541,21.5 12.75,21.5 L6,21.5 C5.44772,21.5 5,21.0523 5,20.5 C5,19.9477 5.44772,19.5 6,19.5 L12.75,19.5 C15.6495,19.5 18,17.1495 18,14.25 C18,11.3505 15.6495,9 12.75,9 L7.41421,9 L10.7071,12.2929 C11.0976,12.6834 11.0976,13.3166 10.7071,13.7071 C10.3166,14.0976 9.68342,14.0976 9.29289,13.7071 L4.29289,8.70711 C3.90237,8.31658 3.90237,7.68342 4.29289,7.29289 L9.29289,2.29289 C9.68342,1.90237 10.3166,1.90237 10.7071,2.29289 Z",id:"\u8def\u5f84",fill:"currentColor"}),r.a.createElement("rect",{id:"\u77e9\u5f62",x:"0",y:"0",width:"24",height:"24"}))))}E.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-trash-2"};var y=E;function L(e){var t=e.className;return r.a.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t},r.a.createElement("title",null,"Rectangle@4x"),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-2423.000000, -6737.000000)",strokeWidth:"2"},r.a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(2141.000000, 6729.000000)"},r.a.createElement("g",{id:"Group-2",transform:"translate(282.000000, 8.000000)"},r.a.createElement("rect",{id:"Rectangle",stroke:"#145AFF",fillOpacity:"0.46",fill:"#158AFF",fillRule:"nonzero",opacity:"0",x:"1",y:"1",width:"22",height:"22"}),r.a.createElement("polyline",{id:"Path",stroke:"#00A34F",strokeLinecap:"round",points:"20.64 6 9.84 16.8 3.36 10.32"}))))))}L.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-save"};var j=L;var O=function(e){var t=e.className;return r.a.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t},r.a.createElement("title",null,"Rectangle@4x"),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-2956.000000, -7360.000000)"},r.a.createElement("g",{id:"\u7f16\u7ec4-42\u5907\u4efd-2",transform:"translate(2714.000000, 7352.000000)"},r.a.createElement("g",{id:"\u53d6\u6d88_normal",transform:"translate(242.000000, 8.000000)"},r.a.createElement("rect",{id:"Rectangle",stroke:"#FF0000",strokeWidth:"2",fillOpacity:"0.48",fill:"#FF5050",opacity:"0",x:"1",y:"1",width:"22",height:"22"}),r.a.createElement("rect",{id:"Rectangle",fill:"#F04632",transform:"translate(12.000000, 12.000000) rotate(-315.000000) translate(-12.000000, -12.000000) ",x:"1",y:"11",width:"22",height:"2",rx:"1"}),r.a.createElement("rect",{id:"Rectangle",fill:"#F04632",transform:"translate(12.000000, 12.000000) rotate(-315.000000) translate(-12.000000, -12.000000) ",x:"11",y:"1",width:"2",height:"22",rx:"1"}))))))},F=n(8),M=n.n(F),N=n(262),W=n(128),A=n(124),B=function(e){return a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"\u7f16\u7ec4",fill:"currentColor"},a.createElement("path",{d:"M2.18181818,12 C2.18181818,17.4224727 6.57757091,21.8181818 12,21.8181818 C17.4224727,21.8181818 21.8181818,17.4224727 21.8181818,12 C21.8181818,6.57757091 17.4224727,2.18181818 12,2.18181818 C6.57757091,2.18181818 2.18181818,6.57757091 2.18181818,12 Z M12,0 C5.37258545,0 0,5.37258545 0,12 C0,18.6273818 5.37258545,24 12,24 C18.6273818,24 24,18.6273818 24,12 C24,5.37258545 18.6273818,0 12,0 Z",id:"\u5f62\u72b6"}))))},P=function(e){var t=e.color,n=e.tool,a=e.onToolChange,o=e.onColorChange,i=e.fixedToWindow,l=e.popupContainer,c=e.onCancel,s=e.undo,d=e.onSave,u=r.a.createElement(A.a,{triangle:"hide",className:"picker",color:t,width:"216px",onChangeComplete:function(e){return o(e.hex)},colors:["#F04632","#FFC700","#00C853","#00E0FF","#4A9EF2","#FF4DFF"]}),f=function(e){return M()({toolButton:!0,toolActive:n===e})};return r.a.createElement("div",{className:"tools",style:i?{position:"fixed"}:{}},r.a.createElement("div",{className:"toolsInner"},r.a.createElement("span",{className:"pickerContainer",id:"pickerContainer"}),r.a.createElement(N.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("rect")},className:f("rect")},r.a.createElement(x,{className:"icon"}))),r.a.createElement(N.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("circle")},className:f("circle")},r.a.createElement(B,{className:"icon"}))),r.a.createElement(N.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("arrow")},className:f("arrow")},r.a.createElement(C,{className:"icon"}))),r.a.createElement(N.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("draw")},className:f("draw")},r.a.createElement(k,{className:"icon"}))),r.a.createElement(N.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("text")},className:f("text")},r.a.createElement(p,{className:"icon"}))),r.a.createElement("hr",{className:"break"}),r.a.createElement("button",{onClick:s,className:M()({toolButton:!0,toolButtonTrash:!1})},r.a.createElement(y,{className:"icon"})),r.a.createElement(W.a,{placement:"top",title:"Cancel",mouseEnterDelay:.5,align:{offset:[-12]},getPopupContainer:l},r.a.createElement("button",{onClick:c,className:"cancel"},r.a.createElement(O,{className:"icon"}))),r.a.createElement(W.a,{placement:"top",title:"Save annotations",mouseEnterDelay:.5,align:{offset:[-12]},getPopupContainer:l},r.a.createElement("button",{onClick:d,className:"save"},r.a.createElement(j,{className:"icon"})))))};P.defaultProps={tool:"",color:"#F04632",popupContainer:function(){return document.getElementById("pickerContainer")}};var S=P,R=n(9);R.fabric.Object.prototype.controls.mtr.visible=!1,R.fabric.Object.prototype.cornerStyle="circle",R.fabric.Object.prototype.cornerStrokeColor="#0E2439",R.fabric.Object.prototype.cornerColor="#FFF",R.fabric.Object.prototype.transparentCorners=!1,R.fabric.Object.prototype.cornerSize=6,R.fabric.Object.prototype.borderColor="#0E2439";var T=n(131),D=["points"],_=R.fabric.util.createClass(R.fabric.Line,{sPoint:null,ePoint:null,sControl:null,eControl:null,type:"arrow",superType:"drawing",initialize:function(e,t){if(this.points=e||[],!e){var n=t,a=n.x1,r=n.x2;e=[a,n.y1,r,n.y2]}t=t||{},this.callSuper("initialize",e,t)},_render:function(e){this.callSuper("_render",e),e.save();var t=this.x2-this.x1,n=this.y2-this.y1,a=Math.atan2(n,t);e.translate((this.x2-this.x1)/2,(this.y2-this.y1)/2),e.rotate(a),e.beginPath(),e.moveTo(10,0),e.lineTo(-10,10),e.lineTo(-10,-10),e.closePath(),e.fillStyle=this.stroke,e.fill(),e.restore()}});_.fromObject=function(e,t){var n=e.x1,a=e.x2,r=e.y1,o=e.y2;return t(new _([n,r,a,o],e))},_.create=function(e){var t=e.points,n=Object(T.a)(e,D);return new _(t,n)};var Z=_,z=function(e){Object(v.a)(n,e);var t=Object(m.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).imageRef=void 0,a.container=void 0,a.activeLine=void 0,a.pointArray=void 0,a.editable=void 0,a.mouseFrom=void 0,a.mouseTo=void 0,a.doDrawing=void 0,a.drawingObject=void 0,a.canvas=void 0,a.stateArr=[],a.stateIdx=0,a.keyupListener=function(){window.addEventListener("keydown",a.onKeydown,!1)},a.state={container:{width:1e3,height:1e3},color:"#F04632",textActive:!1,textEditing:!1,mode:""},a.getCanvasSize=Object(d.a)(s.a.mark((function e(){return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new window.Promise((function(e){var t=new Image;t.onload=function(){var n=t.naturalWidth,a=t.naturalHeight,r=n/a,o=a/n,i=1,l=Math.min(n,document.body.clientWidth),c=Math.min(a,window.innerHeight),s=a-c,d=n-l;(s>0||d>0)&&(s>d?(i=c/a,a=c,n=c*r):d>s&&(i=l/n,n=l,a=l*o)),e({width:n,height:a,scale:i,imageWidth:t.naturalWidth,imageHeight:t.naturalHeight})},t.src=a.props.blob})));case 1:case"end":return e.stop()}}),e)}))),a.buildCanvas=Object(d.a)(s.a.mark((function e(){var t,n,r,o,i=arguments;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:a.props.blob,!a.canvas){e.next=4;break}return a.canvas.renderAll(),e.abrupt("return");case 4:return e.next=6,a.getCanvasSize();case 6:n=e.sent,r=a.imageRef.current,(o=new R.fabric.Canvas(r,{isDrawingMode:!1,imageSmoothingEnabled:!1,selectionColor:"rgba(0,0,0,0.05)"})).setDimensions({width:n.width,height:n.height}),a.canvas=o,o.setBackgroundImage(t,o.renderAll.bind(o),{scaleX:n.scale,scaleY:n.scale}),o.on("object:scaling",(function(e){var t=e.target;!t.strokeWidthUnscaled&&t.strokeWidth&&(t.strokeWidthUnscaled=t.strokeWidth),t.strokeWidthUnscaled&&(t.strokeWidth=t.strokeWidthUnscaled/t.scaleX)})),o.freeDrawingBrush.color=a.state.color,o.freeDrawingBrush.width=4,o.selection=!1,o.on("mouse:down",a.onMouseDown),o.on("mouse:move",a.onMouseMove),o.on("mouse:up",a.onMouseUp);case 19:case"end":return e.stop()}}),e)}))),a.onAfterRender=function(){a.stateArr.push(a.canvas.toJSON()),a.stateIdx++},a.onKeydown=function(e){var t=e.keyCode,n=e.ctrlKey;(function(e){return"Backspace"===e.code||"Delete"===e.code})(e)&&a.remove(),n&&(90===t&&a.undo(),89===t&&a.redo())},a.remove=function(){var e=a.canvas.getActiveObject();e&&a.canvas.remove(e)},a.onMouseDown=function(e){var t=a.state.mode,n=e;if(console.log(n),console.log(n.target),n.target){if("rect"===t||"circle"===t||"arrow"===t)return;if("text"===t&&void 0!==n.target.text)return}"arrow"===t?a.addPoint(n):"text"===t?a.state.textActive&&(a.state.textEditing?a.setState({textEditing:!1}):a.renderText(n.pointer)):"rect"!==t&&"circle"!==t||(a.mouseFrom.x=n.pointer.x,a.mouseFrom.y=n.pointer.y,a.doDrawing=!0)},a.addPoint=function(e){var t=e.absolutePointer,n=t.x,r=t.y,o=new R.fabric.Circle({radius:3,fill:"#ffffff",stroke:"#0E2439",strokeWidth:1,left:n,top:r,selectable:!1,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",hoverCursor:"pointer"}),i=[n,r,n,r];a.activeLine=new Z(i,{strokeWidth:6,fill:"#999999",stroke:a.state.color,class:"line",originX:"center",originY:"center",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1}),a.activeLine.set({class:"line"}),a.pointArray.push(o),a.canvas.add(a.activeLine),a.canvas.add(o)},a.generateArrow=function(e){var t=e.absolutePointer,n=t.x,r=t.y,o=[];a.pointArray.forEach((function(e){o=o.concat(e.left,e.top,n,r),a.canvas.remove(e)})),a.canvas.remove(a.activeLine);var i={points:o,type:"arrow",stroke:a.state.color,strokeWidth:6,opacity:1,objectCaching:!a.editable,name:"New line",superType:"drawing"};a.add(i),a.pointArray=[],a.activeLine=null},a.add=function(e){var t,n=Object(h.a)(a).editable,r={hasControls:!0,hasBorders:!0,selectable:n,lockMovementX:!n,lockMovementY:!n,editable:n},o=Object.assign({},e,{editable:n},r);return t=Z.create(o),a.canvas.add(t),a.forceUpdate(),t},a.onMouseMove=function(e){var t=e,n=a.state.mode;if("arrow"===n){if(a.activeLine&&"line"===a.activeLine.class){var r=a.canvas.getPointer(t.e);a.activeLine.set({x2:r.x,y2:r.y})}a.canvas.requestRenderAll()}else if("rect"===n||"circle"===n){if(!a.doDrawing)return;a.mouseTo.x=t.pointer.x,a.mouseTo.y=t.pointer.y,a.drawing(t)}},a.onMouseUp=function(e){if("arrow"===a.state.mode)a.pointArray.length&&a.activeLine&&a.generateArrow(e);else{var t=e.pointer;a.mouseTo.x=t.x,a.mouseTo.y=t.y,a.canvas.renderAll(),a.drawingObject=null,a.doDrawing=!1}},a.drawing=function(e){a.drawingObject&&a.canvas.remove(a.drawingObject);var t=null,n=a.mouseFrom.x,r=a.mouseFrom.y,o=a.mouseFrom,i=a.mouseTo;switch(a.state.mode){case"rect":e.e.shiftKey&&(i.x-n>i.y-r?i.y=r+i.x-n:i.x=n+i.y-r);var l="M "+o.x+" "+o.y+" L "+i.x+" "+o.y+" L "+i.x+" "+i.y+" L "+o.x+" "+i.y+" L "+o.x+" "+o.y+" z";t=new R.fabric.Path(l,{left:n,top:r,stroke:a.state.color,strokeWidth:4,fill:"rgba(255, 255, 255, 0)",hasControls:!0,hasBorders:!1,padding:-2});break;case"circle":e.e.shiftKey&&(i.x-n>i.y-r?i.y=r+i.x-n:i.x=n+i.y-r),t=new R.fabric.Ellipse({left:(i.x-n)/2+n,top:(i.y-r)/2+r,stroke:a.state.color,fill:"rgba(255, 255, 255, 0)",originX:"center",originY:"center",rx:Math.abs(n-i.x)/2,ry:Math.abs(r-i.y)/2,strokeWidth:4,padding:-2})}t&&(a.canvas.add(t),a.drawingObject=t)},a.handleToolChange=function(e){switch(a.setState({mode:e}),a.canvas.isDrawingMode="draw"===e,a.canvas.defaultCursor="text"===e?"text":"",e){case"mouse":case"rect":case"draw":break;case"arrow":a.initArrow();break;case"text":a.handleText()}},a.initArrow=function(){a.activeLine=null,a.pointArray=[]},a.handleText=function(){a.setState({textActive:!0}),a.canvas.defaultCursor="text"},a.renderText=function(e){var t=e.x,n=e.y,r=new R.fabric.Textbox("",{left:t,top:n,fontFamily:"sans-serif",fontWeight:"bold",fill:a.state.color,transparentCorners:!1,lockRotation:!0,editingBorderColor:"#0E2439",borderColor:"#0E2439",cornerColor:"#0E2439",centeredScaling:!1,borderOpacityWhenMoving:1,hasControls:!1,lockScalingFlip:!0,lockSkewingX:!0,lockSkewingY:!0,cursorWidth:1,width:100,cursorDuration:1,cursorDelay:250,fontSize:16});a.canvas.add(r).setActiveObject(r),a.canvas.bringToFront(r),a.canvas.renderAll(),r.enterEditing(),a.setState({textEditing:!0})},a.handleOk=function(){var e=Object(d.a)(s.a.mark((function e(t){var n,r;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.next=3,a.getCanvasSize();case 3:n=e.sent,r=a.canvas.toDataURL({format:"png",multiplier:1/n.scale}),a.props.onSave(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleCancel=function(){var e;a.canvas&&(e=a.canvas).remove.apply(e,Object(l.a)(a.canvas.getObjects()));a.props.onCancel()},a.handleDelete=function(){a.canvas.remove(a.canvas.getActiveObject())},a.handleColorChange=function(e){a.setState({color:e}),a.canvas.freeDrawingBrush.color=e,a.canvas.stroke=e;var t=a.canvas.getActiveObject();t&&(t.stroke&&t.set({stroke:e}),a.canvas.renderAll())},a.undo=function(){a.canvas.remove(a.canvas.getObjects()[a.canvas.getObjects().length-1])},a.redo=function(){a.canvas.redo()},a.imageRef=r.a.createRef(),a.container=r.a.createRef(),a.activeLine=null,a.pointArray=[],a.editable=!0,a.mouseFrom={},a.mouseTo={},a.doDrawing=!1,a.drawingObject=null,a}return Object(f.a)(n,[{key:"componentDidMount",value:function(){this.buildCanvas(),this.keyupListener()}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"markerContainer",ref:this.container},r.a.createElement("canvas",{className:"image",ref:this.imageRef})),r.a.createElement(S,{tool:this.state.mode,color:this.state.color,onSave:this.handleOk,onCancel:this.handleCancel,popupContainer:this.props.container,onToolChange:this.handleToolChange,onColorChange:this.handleColorChange,fixedToWindow:this.props.toolsFixed,undo:this.undo}))}}]),n}(r.a.Component);z.defaultProps={toolsFixed:!1};var H=z;var I=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(H,{blob:"https://img11.360buyimg.com/imagetools/jfs/t1/159263/28/15023/416077/6065865bE478fb1dc/00e5797fba7243d3.png",onSave:function(){},onCancel:function(){},toolsFixed:!0,container:function(){return document.getElementById("pickerContainer")}}))};n(257);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(I,null)),document.getElementById("root"))},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){}},[[132,1,2]]]);
//# sourceMappingURL=main.816c3659.chunk.js.map