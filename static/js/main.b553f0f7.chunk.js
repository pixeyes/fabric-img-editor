(this["webpackJsonpfabric-img-editor"]=this["webpackJsonpfabric-img-editor"]||[]).push([[0],{132:function(e,t,n){e.exports=n(258)},137:function(e,t,n){var a=n(32),r=n(52);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(52,(function(){"string"===typeof(r=(r=n(52)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},138:function(e,t,n){var a=n(32),r=n(53);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(53,(function(){"string"===typeof(r=(r=n(53)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},139:function(e,t,n){var a=n(32),r=n(54);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(54,(function(){"string"===typeof(r=(r=n(54)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},140:function(e,t,n){var a=n(32),r=n(55);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[e.i,r,""]]);var o={insert:"head",singleton:!1},i=a(r,o);if(!r.locals||e.hot.invalidate){var l=r.locals;e.hot.accept(55,(function(){"string"===typeof(r=(r=n(55)).__esModule?r.default:r)&&(r=[[e.i,r,""]]),function(e,t,n){if(!e&&t||e&&!t)return!1;var a;for(a in e)if((!n||"default"!==a)&&e[a]!==t[a])return!1;for(a in t)if((!n||"default"!==a)&&!e[a])return!1;return!0}(l,r.locals)?(l=r.locals,i(r)):e.hot.invalidate()}))}e.hot.dispose((function(){i()})),e.exports=r.locals||{}},254:function(e,t){},255:function(e,t){},256:function(e,t){},258:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(11),i=n.n(o),l=(n(137),n(138),n(139),n(140),n(126)),s=n(27),c=n.n(s),d=n(51),u=n(106),f=n(107),h=n(45),m=n(130),g=n(127);function v(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-720.000000, -11561.000000)"},r.a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(584.000000, 11553.000000)"},r.a.createElement("g",{id:"\u7f16\u7ec4-41",transform:"translate(136.000000, 8.000000)"},r.a.createElement("g",{id:"\u5706\u5f62\u5907\u4efd-2"},r.a.createElement("rect",{id:"\u77e9\u5f62",x:"0",y:"0",width:"24",height:"24"})),r.a.createElement("g",{id:"\u7f16\u7ec4-39",transform:"translate(4.000000, 4.500000)",stroke:"currentColor",strokeLinecap:"round",strokeWidth:"2"},r.a.createElement("line",{x1:"0",y1:"0.5",x2:"16",y2:"0.5",id:"\u8def\u5f84-19"}),r.a.createElement("line",{x1:"8",y1:"0.5",x2:"8",y2:"15.5",id:"\u8def\u5f84-19"})))))))}v.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-type"};var p=v;function w(e){return r.a.createElement("svg",e,[r.a.createElement("line",{x1:"19",y1:"12",x2:"5",y2:"12",key:0}),r.a.createElement("polyline",{points:"12 19 5 12 12 5",key:1})])}w.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-arrow-left"};var x=w;var k=function(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-600.000000, -11561.000000)"},r.a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(584.000000, 11553.000000)"},r.a.createElement("g",{id:"\u77e9\u5f62",transform:"translate(16.000000, 8.000000)"},r.a.createElement("rect",{x:"0",y:"0",width:"24",height:"24"}),r.a.createElement("rect",{stroke:"currentColor",strokeWidth:"2",x:"5",y:"5",width:"14",height:"14",rx:"1"}))))))};function E(e){return r.a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-680.000000, -11561.000000)",strokeWidth:"2"},r.a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(584.000000, 11553.000000)"},r.a.createElement("g",{id:"\u7f16\u8f91_normal",transform:"translate(96.000000, 8.000000)"},r.a.createElement("rect",{id:"Rectangle",stroke:"#979797",fill:"#D8D8D8",opacity:"0",x:"1",y:"1",width:"22",height:"22"}),r.a.createElement("path",{d:"M18,4.17157288 C18.4679353,4.17157288 18.9358706,4.35008418 19.2928932,4.70710678 C19.6499158,5.06412939 19.8284271,5.53206469 19.8284271,6 C19.8284271,6.46793531 19.6499158,6.93587061 19.2928932,7.29289322 L19.2928932,7.29289322 L6.58578644,20 L4,20 L4,17.4142136 L16.7071068,4.70710678 C17.0641294,4.35008418 17.5320647,4.17157288 18,4.17157288 Z",id:"Path-6",stroke:"currentColor"}))))))}E.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-edit-2"};var y=E;function b(e){return r.a.createElement("svg",{width:"25px",height:"24px",viewBox:"0 0 25 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:e.className},r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-785.000000, -11561.000000)",strokeWidth:"2"},r.a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(584.000000, 11553.000000)"},r.a.createElement("g",{id:"\u7f16\u7ec4-40",transform:"translate(201.000000, 8.000000)"},r.a.createElement("rect",{id:"Rectangle",stroke:"#FF0000",fillOpacity:"0.48",fill:"#FF5050",opacity:"0",x:"1.59667969",y:"1",width:"22",height:"22"}),r.a.createElement("path",{d:"M5.07691956,10 L16.430013,10 C18.7311995,10 20.5966797,12.0147186 20.5966797,14.5 C20.5966797,16.9852814 18.7311995,19 16.430013,19 L7.59667969,19",id:"\u8def\u5f84",stroke:"#FFFFFF",strokeLinecap:"round"}),r.a.createElement("line",{x1:"5",y1:"10.0071716",x2:"10.5966797",y2:"5",id:"\u8def\u5f84-3",stroke:"#FFFFFF",strokeLinecap:"round"}))))))}b.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-trash-2"};var C=b;function F(e){var t=e.className;return r.a.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t},r.a.createElement("title",null,"Rectangle@4x"),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-2423.000000, -6737.000000)",strokeWidth:"2"},r.a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(2141.000000, 6729.000000)"},r.a.createElement("g",{id:"Group-2",transform:"translate(282.000000, 8.000000)"},r.a.createElement("rect",{id:"Rectangle",stroke:"#145AFF",fillOpacity:"0.46",fill:"#158AFF",fillRule:"nonzero",opacity:"0",x:"1",y:"1",width:"22",height:"22"}),r.a.createElement("polyline",{id:"Path",stroke:"#00A34F",strokeLinecap:"round",points:"20.64 6 9.84 16.8 3.36 10.32"}))))))}F.defaultProps={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"feather feather-save"};var L=F;var W=function(e){var t=e.className;return r.a.createElement("svg",{width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg",className:t},r.a.createElement("title",null,"Rectangle@4x"),r.a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},r.a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-2956.000000, -7360.000000)"},r.a.createElement("g",{id:"\u7f16\u7ec4-42\u5907\u4efd-2",transform:"translate(2714.000000, 7352.000000)"},r.a.createElement("g",{id:"\u53d6\u6d88_normal",transform:"translate(242.000000, 8.000000)"},r.a.createElement("rect",{id:"Rectangle",stroke:"#FF0000",strokeWidth:"2",fillOpacity:"0.48",fill:"#FF5050",opacity:"0",x:"1",y:"1",width:"22",height:"22"}),r.a.createElement("rect",{id:"Rectangle",fill:"#F04632",transform:"translate(12.000000, 12.000000) rotate(-315.000000) translate(-12.000000, -12.000000) ",x:"1",y:"11",width:"22",height:"2",rx:"1"}),r.a.createElement("rect",{id:"Rectangle",fill:"#F04632",transform:"translate(12.000000, 12.000000) rotate(-315.000000) translate(-12.000000, -12.000000) ",x:"11",y:"1",width:"2",height:"22",rx:"1"}))))))},N=n(8),j=n.n(N),O=n(262),A=n(128),M=n(124),B=function(e){return a.createElement("svg",Object.assign({width:"24px",height:"24px",viewBox:"0 0 24 24",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},e),a.createElement("g",{id:"\u9875\u9762-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},a.createElement("g",{id:"\u6807\u6ce8\u5de5\u5177\u680f+\u521b\u5efa\u4efb\u52a1\u7684\u56db\u79cd\u65b9\u5f0f",transform:"translate(-640.000000, -11561.000000)"},a.createElement("g",{id:"\u7f16\u7ec4-42",transform:"translate(584.000000, 11553.000000)"},a.createElement("g",{id:"\u5706\u5f62",transform:"translate(56.000000, 8.000000)"},a.createElement("rect",{id:"\u77e9\u5f62",x:"0",y:"0",width:"24",height:"24"}),a.createElement("rect",{id:"\u77e9\u5f62",stroke:"currentColor",strokeWidth:"2",x:"4",y:"4",width:"16",height:"16",rx:"8"}))))))},P=function(e){var t=e.color,n=e.tool,a=e.onToolChange,o=e.onColorChange,i=e.fixedToWindow,l=e.popupContainer,s=e.onCancel,c=e.undo,d=e.onSave,u=r.a.createElement(M.a,{triangle:"hide",className:"picker",color:t,onChangeComplete:function(e){return o(e.hex)},colors:["#FF2600","#00B4FF","#61ED00","#FFEB01","#929292","#FFFFFF"]}),f=function(e){return j()({toolButton:!0,toolActive:n===e})};return r.a.createElement("div",{className:"tools",style:i?{position:"fixed"}:{}},r.a.createElement("div",{className:"toolsInner"},r.a.createElement("span",{className:"pickerContainer",id:"pickerContainer"}),r.a.createElement(O.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("rect")},className:f("rect")},r.a.createElement(k,{className:"icon"}))),r.a.createElement(O.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("circle")},className:f("circle")},r.a.createElement(B,{className:"icon"}))),r.a.createElement(O.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("arrow")},className:f("arrow")},r.a.createElement(x,{className:"icon"}))),r.a.createElement(O.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("draw")},className:f("draw")},r.a.createElement(y,{className:"icon"}))),r.a.createElement(O.a,{trigger:"click",content:u,getPopupContainer:l},r.a.createElement("button",{onClick:function(){return a("text")},className:f("text")},r.a.createElement(p,{className:"icon"}))),r.a.createElement("button",{onClick:c,className:j()({toolButton:!0,toolButtonTrash:!1})},r.a.createElement(C,{className:"icon"})),r.a.createElement("hr",{className:"break"}),r.a.createElement(A.a,{placement:"top",title:"Cancel",mouseEnterDelay:.5,align:{offset:[-12]},getPopupContainer:l},r.a.createElement("button",{onClick:s,className:"cancel"},r.a.createElement(W,{className:"icon"}))),r.a.createElement(A.a,{placement:"top",title:"Save annotations",mouseEnterDelay:.5,align:{offset:[-12]},getPopupContainer:l},r.a.createElement("button",{onClick:d,className:"save"},r.a.createElement(L,{className:"icon"})))))};P.defaultProps={tool:"",color:"#F04632",popupContainer:function(){return document.getElementById("pickerContainer")}};var R=P,D=n(15),T=n(131),S=["points"],_=D.fabric.util.createClass(D.fabric.Line,{sPoint:null,ePoint:null,sControl:null,eControl:null,type:"arrow",superType:"drawing",initialize:function(e,t){if(this.points=e||[],!e){var n=t,a=n.x1,r=n.x2;e=[a,n.y1,r,n.y2]}t=t||{},this.callSuper("initialize",e,t)},_render:function(e){this.callSuper("_render",e),e.save();var t=this.x2-this.x1,n=this.y2-this.y1,a=Math.atan2(n,t);e.translate((this.x2-this.x1)/2,(this.y2-this.y1)/2),e.rotate(a),e.beginPath(),e.moveTo(5,0),e.lineTo(-5,5),e.lineTo(-5,-5),e.closePath(),e.fillStyle=this.stroke,e.fill(),e.restore()}});_.fromObject=function(e,t){var n=e.x1,a=e.x2,r=e.y1,o=e.y2;return t(new _([n,r,a,o],e))},_.create=function(e){var t=e.points,n=Object(T.a)(e,S);return new _(t,n)};var I=_,U=function(e){Object(m.a)(n,e);var t=Object(g.a)(n);function n(e){var a;return Object(u.a)(this,n),(a=t.call(this,e)).imageRef=void 0,a.container=void 0,a.activeLine=void 0,a.pointArray=void 0,a.editable=void 0,a.mouseFrom=void 0,a.mouseTo=void 0,a.doDrawing=void 0,a.drawingObject=void 0,a.canvas=void 0,a.stateArr=[],a.stateIdx=0,a.keyupListener=function(){window.addEventListener("keydown",a.onKeydown,!1)},a.state={container:{width:1e3,height:1e3},color:"#F04632",textActive:!1,textEditing:!1,mode:""},a.getCanvasSize=Object(d.a)(c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new window.Promise((function(e){var t=new Image;t.onload=function(){var n=t.naturalWidth,a=t.naturalHeight,r=n/a,o=a/n,i=1,l=Math.min(n,document.body.clientWidth),s=Math.min(a,window.innerHeight),c=a-s,d=n-l;(c>0||d>0)&&(c>d?(i=s/a,a=s,n=s*r):d>c&&(i=l/n,n=l,a=l*o)),e({width:n,height:a,scale:i,imageWidth:t.naturalWidth,imageHeight:t.naturalHeight})},t.src=a.props.blob})));case 1:case"end":return e.stop()}}),e)}))),a.buildCanvas=Object(d.a)(c.a.mark((function e(){var t,n,r,o,i=arguments;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=i.length>0&&void 0!==i[0]?i[0]:a.props.blob,!a.canvas){e.next=4;break}return a.canvas.renderAll(),e.abrupt("return");case 4:return e.next=6,a.getCanvasSize();case 6:n=e.sent,r=a.imageRef.current,(o=new D.fabric.Canvas(r,{isDrawingMode:!1,imageSmoothingEnabled:!1,selectionColor:"rgba(0,0,0,0.05)"})).setDimensions({width:n.width,height:n.height}),a.canvas=o,o.setBackgroundImage(t,o.renderAll.bind(o),{scaleX:n.scale,scaleY:n.scale}),o.on("object:scaling",(function(e){var t=e.target;!t.strokeWidthUnscaled&&t.strokeWidth&&(t.strokeWidthUnscaled=t.strokeWidth),t.strokeWidthUnscaled&&(t.strokeWidth=t.strokeWidthUnscaled/t.scaleX)})),o.freeDrawingBrush.color=a.state.color,o.freeDrawingBrush.width=1,o.on("mouse:down",a.onMouseDown),o.on("mouse:move",a.onMouseMove),o.on("mouse:up",a.onMouseUp);case 18:case"end":return e.stop()}}),e)}))),a.onAfterRender=function(){a.stateArr.push(a.canvas.toJSON()),a.stateIdx++},a.onKeydown=function(e){var t=e.keyCode,n=e.ctrlKey;(function(e){return"Backspace"===e.code||"Delete"===e.code})(e)&&a.remove(),n&&(90===t&&a.undo(),89===t&&a.redo())},a.remove=function(){var e=a.canvas.getActiveObject();e&&a.canvas.remove(e)},a.onMouseDown=function(e){var t=a.state.mode,n=e;null===n.target&&("arrow"===t?a.pointArray.length&&a.activeLine?a.generateArrow(n):a.addPoint(n):"text"===t?a.state.textActive&&(a.state.textEditing?a.setState({textEditing:!1}):a.renderText(n.pointer)):"rect"!==t&&"circle"!==t||(a.mouseFrom.x=n.pointer.x,a.mouseFrom.y=n.pointer.y,a.doDrawing=!0))},a.addPoint=function(e){var t=e.absolutePointer,n=t.x,r=t.y,o=new D.fabric.Circle({radius:3,fill:"#ffffff",stroke:"#333333",strokeWidth:.5,left:n,top:r,selectable:!1,hasBorders:!1,hasControls:!1,originX:"center",originY:"center",hoverCursor:"pointer"});a.pointArray.length||o.set({fill:"red"});var i=[n,r,n,r];a.activeLine=new I(i,{strokeWidth:2,fill:"#999999",stroke:a.state.color,class:"line",originX:"center",originY:"center",selectable:!1,hasBorders:!1,hasControls:!1,evented:!1}),a.activeLine.set({class:"line"}),a.pointArray.push(o),a.canvas.add(a.activeLine),a.canvas.add(o)},a.generateArrow=function(e){var t=e.absolutePointer,n=t.x,r=t.y,o=[];a.pointArray.forEach((function(e){o=o.concat(e.left,e.top,n,r),a.canvas.remove(e)})),a.canvas.remove(a.activeLine);var i={points:o,type:"arrow",stroke:a.state.color,strokeWidth:3,opacity:1,objectCaching:!a.editable,name:"New line",superType:"drawing"};a.add(i),a.pointArray=[],a.activeLine=null},a.add=function(e){var t,n=Object(h.a)(a).editable,r={hasControls:n,hasBorders:n,selectable:n,lockMovementX:!n,lockMovementY:!n,hoverCursor:n?"default":"pointer",editable:n},o=Object.assign({},e,{editable:n},r);return t=I.create(o),a.canvas.add(t),a.forceUpdate(),t},a.onMouseMove=function(e){var t=e,n=a.state.mode;if("arrow"===n){if(a.activeLine&&"line"===a.activeLine.class){var r=a.canvas.getPointer(t.e);a.activeLine.set({x2:r.x,y2:r.y})}a.canvas.requestRenderAll()}else if("rect"===n||"circle"===n){if(!a.doDrawing)return;a.mouseTo.x=t.pointer.x,a.mouseTo.y=t.pointer.y,a.drawing(t)}},a.onMouseUp=function(e){var t=e.pointer;a.mouseTo.x=t.x,a.mouseTo.y=t.y,a.canvas.renderAll(),a.drawingObject=null,a.doDrawing=!1},a.drawing=function(e){a.drawingObject&&a.canvas.remove(a.drawingObject);var t=null,n=a.mouseFrom.x,r=a.mouseFrom.y,o=a.mouseFrom,i=a.mouseTo;switch(a.state.mode){case"rect":e.e.shiftKey&&(i.x-n>i.y-r?i.y=r+i.x-n:i.x=n+i.y-r);var l="M "+o.x+" "+o.y+" L "+i.x+" "+o.y+" L "+i.x+" "+i.y+" L "+o.x+" "+i.y+" L "+o.x+" "+o.y+" z";t=new D.fabric.Path(l,{left:n,top:r,stroke:a.state.color,strokeWidth:1,fill:"rgba(255, 255, 255, 0)",hasControls:!0});break;case"circle":e.e.shiftKey&&(i.x-n>i.y-r?i.y=r+i.x-n:i.x=n+i.y-r),t=new D.fabric.Ellipse({left:(i.x-n)/2+n,top:(i.y-r)/2+r,stroke:a.state.color,fill:"rgba(255, 255, 255, 0)",originX:"center",originY:"center",rx:Math.abs(n-i.x)/2,ry:Math.abs(r-i.y)/2,strokeWidth:2})}t&&(a.canvas.add(t),a.drawingObject=t)},a.handleToolChange=function(e){switch(a.setState({mode:e}),a.canvas.isDrawingMode="draw"===e,a.canvas.defaultCursor="text"===e?"text":"",e){case"mouse":break;case"arrow":a.initArrow();break;case"rect":case"draw":break;case"text":a.handleText()}},a.initArrow=function(){a.activeLine=null,a.pointArray=[]},a.handleText=function(){a.setState({textActive:!0}),a.canvas.defaultCursor="text"},a.renderText=function(e){var t=e.x,n=e.y,r=new D.fabric.Textbox("",{left:t,top:n,fontFamily:"sans-serif",fill:a.state.color,transparentCorners:!1,lockRotation:!0,borderColor:"#0E98FC",cornerColor:"#0E98FC",centeredScaling:!1,borderOpacityWhenMoving:1,hasControls:!1,lockScalingFlip:!0,lockSkewingX:!0,lockSkewingY:!0,cursorWidth:1,width:100,cursorDuration:1,cursorDelay:250});a.canvas.add(r).setActiveObject(r),a.canvas.bringToFront(r),a.canvas.renderAll(),r.enterEditing(),a.setState({textEditing:!0})},a.handleOk=function(){var e=Object(d.a)(c.a.mark((function e(t){var n,r;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.stopPropagation(),e.next=3,a.getCanvasSize();case 3:n=e.sent,r=a.canvas.toDataURL({format:"png",multiplier:1/n.scale}),a.props.onSave(r);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleCancel=function(){var e;a.canvas&&(e=a.canvas).remove.apply(e,Object(l.a)(a.canvas.getObjects()));a.props.onCancel()},a.handleDelete=function(){a.canvas.remove(a.canvas.getActiveObject())},a.handleColorChange=function(e){a.setState({color:e}),a.canvas.freeDrawingBrush.color=e,a.canvas.stroke=e;var t=a.canvas.getActiveObject();t&&(t.stroke&&t.set({stroke:e}),a.canvas.renderAll())},a.undo=function(){a.canvas.remove(a.canvas.getObjects()[a.canvas.getObjects().length-1])},a.redo=function(){a.canvas.redo()},a.imageRef=r.a.createRef(),a.container=r.a.createRef(),a.activeLine=null,a.pointArray=[],a.editable=!0,a.mouseFrom={},a.mouseTo={},a.doDrawing=!1,a.drawingObject=null,a}return Object(f.a)(n,[{key:"componentDidMount",value:function(){this.buildCanvas(),this.keyupListener()}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"markerContainer",ref:this.container},r.a.createElement("canvas",{className:"image",ref:this.imageRef})),r.a.createElement(R,{tool:this.state.mode,color:this.state.color,onSave:this.handleOk,onCancel:this.handleCancel,popupContainer:this.props.container,onToolChange:this.handleToolChange,onColorChange:this.handleColorChange,fixedToWindow:this.props.toolsFixed,undo:this.undo}))}}]),n}(r.a.Component);U.defaultProps={toolsFixed:!1};var z=U;var X=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(z,{blob:"https://img11.360buyimg.com/imagetools/jfs/t1/159263/28/15023/416077/6065865bE478fb1dc/00e5797fba7243d3.png",onSave:function(){},onCancel:function(){},toolsFixed:!0,container:function(){return document.getElementById("pickerContainer")}}))};n(257);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(X,null)),document.getElementById("root"))},52:function(e,t,n){},53:function(e,t,n){},54:function(e,t,n){},55:function(e,t,n){}},[[132,1,2]]]);
//# sourceMappingURL=main.b553f0f7.chunk.js.map